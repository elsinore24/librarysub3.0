import{s as ae,d as $,i as Y,b as k,l as _,u as w,c as V,e as C,g as T,m as Z,h as M,j as A,o as ie,v as re,n as x,w as O,x as fe,r as ue,q as J}from"../chunks/CzRFqhbG.js";import{S as ce,i as de,d as j,a as I,t as v,c as K,m as F,b as R,e as q,f as G,g as Q}from"../chunks/CPVu1_AZ.js";import{V as me,C as W,F as he,B as pe,S as ve,f as U,a as ge}from"../chunks/C9gNres7.js";import{e as _e}from"../chunks/2gw5FMqC.js";import{S as B}from"../chunks/BLNg_MBi.js";import{b as be}from"../chunks/OuAugre_.js";function ee(a){let e,t;return e=new he({props:{books:a[8]}}),{c(){q(e.$$.fragment)},l(l){R(e.$$.fragment,l)},m(l,s){F(e,l,s),t=!0},p:x,i(l){t||(v(e.$$.fragment,l),t=!0)},o(l){I(e.$$.fragment,l),t=!1},d(l){j(e,l)}}}function te(a){let e;return{c(){e=M("div"),this.h()},l(t){e=V(t,"DIV",{class:!0,style:!0}),C(e).forEach($),this.h()},h(){_(e,"class","touch-feedback svelte-1l1tmgf"),w(e,"left",a[5].x+"%"),w(e,"top",a[5].y+"%"),w(e,"opacity",a[4]>.3?.7:.4),w(e,"transform","scale("+(1+a[4])+")")},m(t,l){Y(t,e,l)},p(t,l){l&32&&w(e,"left",t[5].x+"%"),l&32&&w(e,"top",t[5].y+"%"),l&16&&w(e,"opacity",t[4]>.3?.7:.4),l&16&&w(e,"transform","scale("+(1+t[4])+")")},d(t){t&&$(e)}}}function le(a){let e,t,l,s,n,r,E,m;const y=[$e,ke],g=[];function z(o,i){return o[0]?1:0}l=z(a),s=g[l]=y[l](a);let f=a[1]&&ne();return{c(){e=M("main"),t=M("div"),s.c(),n=A(),f&&f.c(),this.h()},l(o){e=V(o,"MAIN",{class:!0});var i=C(e);t=V(i,"DIV",{class:!0});var d=C(t);s.l(d),n=T(d),f&&f.l(d),d.forEach($),i.forEach($),this.h()},h(){_(t,"class",r="puzzle-container relative p-4 md:p-8 rounded-lg border-0 w-full max-w-2xl "+(a[1]?"solved":"")+" svelte-1l1tmgf"),_(e,"class","relative z-20 max-w-6xl mx-auto px-4 py-4 md:py-12 min-h-screen flex items-center justify-content: center")},m(o,i){Y(o,e,i),k(e,t),g[l].m(t,null),k(t,n),f&&f.m(t,null),m=!0},p(o,i){let d=l;l=z(o),l===d?g[l].p(o,i):(Q(),I(g[d],1,1,()=>{g[d]=null}),K(),s=g[l],s?s.p(o,i):(s=g[l]=y[l](o),s.c()),v(s,1),s.m(t,n)),o[1]?f?i&2&&v(f,1):(f=ne(),f.c(),v(f,1),f.m(t,null)):f&&(Q(),I(f,1,1,()=>{f=null}),K()),(!m||i&2&&r!==(r="puzzle-container relative p-4 md:p-8 rounded-lg border-0 w-full max-w-2xl "+(o[1]?"solved":"")+" svelte-1l1tmgf"))&&_(t,"class",r)},i(o){m||(v(s),v(f),o&&(E||O(()=>{E=G(e,U,{duration:1e3,delay:300}),E.start()})),m=!0)},o(o){I(s),I(f),m=!1},d(o){o&&$(e),g[l].d(),f&&f.d()}}}function ke(a){let e,t,l,s;return t=new pe({props:{books:a[8],disabled:a[1]}}),t.$on("solve",a[9]),{c(){e=M("div"),q(t.$$.fragment),this.h()},l(n){e=V(n,"DIV",{class:!0});var r=C(e);R(t.$$.fragment,r),r.forEach($),this.h()},h(){_(e,"class","puzzle-wrapper svelte-1l1tmgf")},m(n,r){Y(n,e,r),F(t,e,null),s=!0},p(n,r){const E={};r&2&&(E.disabled=n[1]),t.$set(E)},i(n){s||(v(t.$$.fragment,n),n&&(l||O(()=>{l=G(e,U,{duration:800}),l.start()})),s=!0)},o(n){I(t.$$.fragment,n),s=!1},d(n){n&&$(e),j(t)}}}function $e(a){let e,t,l,s,n,r,E="A peculiar arrangement of books catches your eye...",m,y,g,z,f,o=a[4]>.5&&a[4]<.8&&se();return{c(){e=M("div"),t=M("div"),l=M("div"),s=A(),n=M("div"),r=M("span"),r.textContent=E,m=A(),o&&o.c(),this.h()},l(i){e=V(i,"DIV",{class:!0});var d=C(e);t=V(d,"DIV",{class:!0,role:!0,"aria-label":!0,tabindex:!0});var S=C(t);l=V(S,"DIV",{class:!0,style:!0}),C(l).forEach($),s=T(S),n=V(S,"DIV",{class:!0,style:!0});var P=C(n);r=V(P,"SPAN",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-1bbeums"&&(r.textContent=E),P.forEach($),m=T(S),o&&o.l(S),S.forEach($),d.forEach($),this.h()},h(){_(l,"class","bookshelf-highlight svelte-1l1tmgf"),w(l,"opacity",a[4]>.3?a[4]:0),_(r,"class","hint-text svelte-1l1tmgf"),_(n,"class","bookshelf-hint svelte-1l1tmgf"),w(n,"opacity",a[3]?1:0),w(n,"transform","translateY("+(a[3]?0:10)+"px)"),_(t,"class",y="bookshelf-area "+(a[3]?"hovered":"")+" svelte-1l1tmgf"),_(t,"role","button"),_(t,"aria-label","Interact with the bookshelf"),_(t,"tabindex","0"),_(e,"class","bookshelf-interactive svelte-1l1tmgf")},m(i,d){Y(i,e,d),k(e,t),k(t,l),k(t,s),k(t,n),k(n,r),k(t,m),o&&o.m(t,null),z||(f=[J(t,"click",a[10]),J(t,"mouseenter",a[11]),J(t,"mouseleave",a[12]),J(t,"keydown",a[13])],z=!0)},p(i,d){d&16&&w(l,"opacity",i[4]>.3?i[4]:0),d&8&&w(n,"opacity",i[3]?1:0),d&8&&w(n,"transform","translateY("+(i[3]?0:10)+"px)"),i[4]>.5&&i[4]<.8?o?d&16&&v(o,1):(o=se(),o.c(),v(o,1),o.m(t,null)):o&&(o.d(1),o=null),d&8&&y!==(y="bookshelf-area "+(i[3]?"hovered":"")+" svelte-1l1tmgf")&&_(t,"class",y)},i(i){v(o),i&&(g||O(()=>{g=G(e,U,{duration:500}),g.start()}))},o:x,d(i){i&&$(e),o&&o.d(),z=!1,ue(f)}}}function se(a){let e,t="<span>Hold to examine...</span>",l;return{c(){e=M("div"),e.innerHTML=t,this.h()},l(s){e=V(s,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-zyjqha"&&(e.innerHTML=t),this.h()},h(){_(e,"class","mobile-hint svelte-1l1tmgf")},m(s,n){Y(s,e,n)},i(s){s&&(l||O(()=>{l=G(e,U,{duration:300}),l.start()}))},o:x,d(s){s&&$(e)}}}function ne(a){let e,t,l,s;return t=new ve({props:{visible:!0}}),{c(){e=M("div"),q(t.$$.fragment),this.h()},l(n){e=V(n,"DIV",{class:!0});var r=C(e);R(t.$$.fragment,r),r.forEach($),this.h()},h(){_(e,"class","mt-8")},m(n,r){Y(n,e,r),F(t,e,null),s=!0},i(n){s||(v(t.$$.fragment,n),n&&(l||O(()=>{l=G(e,ge,{y:20,duration:800}),l.start()})),s=!0)},o(n){I(t.$$.fragment,n),s=!1},d(n){n&&$(e),j(t)}}}function ye(a){let e,t,l,s,n,r,E=`<a href="${be}/" class="text-parchment hover:text-accent transition-colors duration-300 text-lg">‚Üê Return Home</a>`,m,y,g,z,f,o,i,d,S,P,N;s=new me({props:{intensity:a[1]?.18:.12,flickerSpeed:.15}}),y=new W({props:{size:"large",position:{x:50,y:20},intensity:a[1]?1.2:1}}),z=new W({props:{size:"medium",position:{x:15,y:40}}}),o=new W({props:{size:"medium",position:{x:85,y:40}}});let h=!a[0]&&ee(a),b=a[6]&&te(a),p=a[2]&&le(a);return{c(){e=M("div"),t=M("div"),l=A(),q(s.$$.fragment),n=A(),r=M("div"),r.innerHTML=E,m=A(),q(y.$$.fragment),g=A(),q(z.$$.fragment),f=A(),q(o.$$.fragment),i=A(),d=M("div"),h&&h.c(),S=A(),b&&b.c(),P=A(),p&&p.c(),this.h()},l(u){e=V(u,"DIV",{class:!0,style:!0});var c=C(e);t=V(c,"DIV",{class:!0}),C(t).forEach($),l=T(c),R(s.$$.fragment,c),n=T(c),r=V(c,"DIV",{class:!0,"data-svelte-h":!0}),Z(r)!=="svelte-juls2g"&&(r.innerHTML=E),m=T(c),R(y.$$.fragment,c),g=T(c),R(z.$$.fragment,c),f=T(c),R(o.$$.fragment,c),i=T(c),d=V(c,"DIV",{class:!0});var L=C(d);h&&h.l(L),L.forEach($),S=T(c),b&&b.l(c),P=T(c),p&&p.l(c),c.forEach($),this.h()},h(){_(t,"class","absolute inset-0 bg-black/50 z-0"),_(r,"class","absolute bottom-8 left-8 z-50"),_(d,"class","absolute inset-0 z-10"),_(e,"class","library-container min-h-screen overflow-hidden relative svelte-1l1tmgf"),w(e,"background-image","url("+ze+")"),w(e,"background-size","cover"),w(e,"background-position","center")},m(u,c){Y(u,e,c),k(e,t),k(e,l),F(s,e,null),k(e,n),k(e,r),k(e,m),F(y,e,null),k(e,g),F(z,e,null),k(e,f),F(o,e,null),k(e,i),k(e,d),h&&h.m(d,null),k(e,S),b&&b.m(e,null),k(e,P),p&&p.m(e,null),a[14](e),N=!0},p(u,[c]){const L={};c&2&&(L.intensity=u[1]?.18:.12),s.$set(L);const X={};c&2&&(X.intensity=u[1]?1.2:1),y.$set(X),u[0]?h&&(Q(),I(h,1,1,()=>{h=null}),K()):h?(h.p(u,c),c&1&&v(h,1)):(h=ee(u),h.c(),v(h,1),h.m(d,null)),u[6]?b?b.p(u,c):(b=te(u),b.c(),b.m(e,P)):b&&(b.d(1),b=null),u[2]?p?(p.p(u,c),c&4&&v(p,1)):(p=le(u),p.c(),v(p,1),p.m(e,null)):p&&(Q(),I(p,1,1,()=>{p=null}),K())},i(u){N||(v(s.$$.fragment,u),v(y.$$.fragment,u),v(z.$$.fragment,u),v(o.$$.fragment,u),v(h),v(p),N=!0)},o(u){I(s.$$.fragment,u),I(y.$$.fragment,u),I(z.$$.fragment,u),I(o.$$.fragment,u),I(h),I(p),N=!1},d(u){u&&$(e),j(s),j(y),j(z),j(o),h&&h.d(),b&&b.d(),p&&p.d(),a[14](null)}}}const ze="https://kxmwcpeuiklblpehddkz.supabase.co/storage/v1/object/public/suspects//library.jpeg";function we(a,e,t,l){return Math.sqrt(Math.pow(t-a,2)+Math.pow(l-e,2))}function Ee(a,e,t){let l=!1,s=!1,n=!1,r=!1,E=!1,m=0;const y=[{id:1,title:"Mortiferous Mushrooms",color:"#8C0000"},{id:2,title:"Aconitum Anthology",color:"#2A003C"},{id:3,title:"Venomous Flora",color:"#39FF14"},{id:4,title:"Dark Rituals",color:"#0A0004"}],g={x:50,y:40,radius:20};let z=0,f={x:0,y:0},o=!1,i;ie(()=>{B.playAmbient("library-ambience",{volume:.3,fade:!0,fadeIn:3e3}),setTimeout(()=>t(2,n=!0),100),d()}),re(()=>{B.stopAmbient("library-ambience",{fade:!0,fadeOut:2e3})});function d(){i&&(i.addEventListener("touchstart",S),i.addEventListener("touchmove",P),i.addEventListener("touchend",N))}function S(D){if(l)return;z=Date.now();const H=D.touches[0];h(H),t(6,o=!0),b()}function P(D){if(l)return;const H=D.touches[0];h(H),b()}function N(D){if(l)return;const H=Date.now()-z;t(6,o=!1),H>300&&m>.7&&u()}function h(D){const H=i.getBoundingClientRect();t(5,f={x:(D.clientX-H.left)/H.width*100,y:(D.clientY-H.top)/H.height*100})}function b(){const D=we(f.x,f.y,g.x,g.y);t(4,m=Math.max(0,1-D/g.radius)),t(3,r=m>.3),m>.7&&navigator.vibrate&&navigator.vibrate(Math.floor(m*30)),m>.5&&!E?(E=!0,B.playEffect("creak",{volume:m*.3})):m<.3&&(E=!1)}async function p(){t(1,s=!0),console.log("Puzzle solved, setting puzzleSolved to:",s),B.playEffect("puzzle-solve",{volume:.5}),_e.update(D=>[...D,{id:"book-puzzle",description:"The arrangement reveals a hidden message about poisonous plants...",discovered_at:new Date().toISOString(),image:"/images/clues/poisoned-page.png"}]),B.playEffect("secret-reveal",{volume:.4,fade:!0,fadeIn:1e3})}function u(){l||(t(0,l=!0),B.playEffect("bookshelf-creak",{volume:.4}))}function c(){!l&&!r&&(t(3,r=!0),B.playEffect("creak",{volume:.2}))}const L=()=>t(3,r=!1),X=D=>D.key==="Enter"&&u();function oe(D){fe[D?"unshift":"push"](()=>{i=D,t(7,i)})}return[l,s,n,r,m,f,o,i,y,p,u,c,L,X,oe]}class Te extends ce{constructor(e){super(),de(this,e,Ee,ye,ae,{})}}export{Te as component};
