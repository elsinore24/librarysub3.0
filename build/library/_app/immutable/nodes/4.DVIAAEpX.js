import{s as ae,d as y,i as j,b as k,l as b,u as M,c as V,e as L,g as C,m as Z,h as S,j as H,o as re,v as fe,n as ee,w as J,x as ue,r as ce,q as W}from"../chunks/CzRFqhbG.js";import{S as de,i as me,d as R,a as I,t as p,c as Q,m as O,b as Y,e as N,f as K,g as U,h as pe}from"../chunks/CPVu1_AZ.js";import{V as he,C as x,F as ve,f as X,B as _e,S as be,a as ge}from"../chunks/C9gNres7.js";import{e as ke}from"../chunks/2gw5FMqC.js";import{S as q}from"../chunks/BLNg_MBi.js";import{b as ye}from"../chunks/OuAugre_.js";const $e=!1,Pe=Object.freeze(Object.defineProperty({__proto__:null,ssr:$e},Symbol.toStringTag,{value:"Module"}));function te(a){let e,t;return e=new ve({props:{books:a[8]}}),{c(){N(e.$$.fragment)},l(l){Y(e.$$.fragment,l)},m(l,s){O(e,l,s),t=!0},p:ee,i(l){t||(p(e.$$.fragment,l),t=!0)},o(l){I(e.$$.fragment,l),t=!1},d(l){R(e,l)}}}function le(a){let e;return{c(){e=S("div"),this.h()},l(t){e=V(t,"DIV",{class:!0,style:!0}),L(e).forEach(y),this.h()},h(){b(e,"class","touch-feedback svelte-slpekr"),M(e,"left",a[5].x+"%"),M(e,"top",a[5].y+"%"),M(e,"opacity",a[4]>.3?.7:.4),M(e,"transform","scale("+(1+a[4])+")")},m(t,l){j(t,e,l)},p(t,l){l&32&&M(e,"left",t[5].x+"%"),l&32&&M(e,"top",t[5].y+"%"),l&16&&M(e,"opacity",t[4]>.3?.7:.4),l&16&&M(e,"transform","scale("+(1+t[4])+")")},d(t){t&&y(e)}}}function se(a){let e,t,l,s,n,i,z,h;const w=[we,ze],g=[];function D(o,r){return o[0]?1:0}l=D(a),s=g[l]=w[l](a);let u=a[1]&&ie();return{c(){e=S("main"),t=S("div"),s.c(),n=H(),u&&u.c(),this.h()},l(o){e=V(o,"MAIN",{class:!0});var r=L(e);t=V(r,"DIV",{class:!0});var d=L(t);s.l(d),n=C(d),u&&u.l(d),d.forEach(y),r.forEach(y),this.h()},h(){b(t,"class",i="puzzle-container relative p-4 md:p-8 rounded-lg border-0 w-full max-w-2xl "+(a[1]?"solved":"")+" svelte-slpekr"),b(e,"class","relative z-20 max-w-6xl mx-auto px-4 py-4 md:py-12 min-h-screen flex items-center justify-center")},m(o,r){j(o,e,r),k(e,t),g[l].m(t,null),k(t,n),u&&u.m(t,null),h=!0},p(o,r){let d=l;l=D(o),l===d?g[l].p(o,r):(U(),I(g[d],1,1,()=>{g[d]=null}),Q(),s=g[l],s?s.p(o,r):(s=g[l]=w[l](o),s.c()),p(s,1),s.m(t,n)),o[1]?u?r&2&&p(u,1):(u=ie(),u.c(),p(u,1),u.m(t,null)):u&&(U(),I(u,1,1,()=>{u=null}),Q()),(!h||r&2&&i!==(i="puzzle-container relative p-4 md:p-8 rounded-lg border-0 w-full max-w-2xl "+(o[1]?"solved":"")+" svelte-slpekr"))&&b(t,"class",i)},i(o){h||(p(s),p(u),o&&(z||J(()=>{z=K(e,X,{duration:1e3,delay:300}),z.start()})),h=!0)},o(o){I(s),I(u),h=!1},d(o){o&&y(e),g[l].d(),u&&u.d()}}}function ze(a){let e,t,l,s;return t=new _e({props:{books:a[8],disabled:a[1]}}),t.$on("solve",a[9]),{c(){e=S("div"),N(t.$$.fragment),this.h()},l(n){e=V(n,"DIV",{class:!0});var i=L(e);Y(t.$$.fragment,i),i.forEach(y),this.h()},h(){b(e,"class","puzzle-wrapper svelte-slpekr")},m(n,i){j(n,e,i),O(t,e,null),s=!0},p(n,i){const z={};i&2&&(z.disabled=n[1]),t.$set(z)},i(n){s||(p(t.$$.fragment,n),n&&(l||J(()=>{l=K(e,X,{duration:800}),l.start()})),s=!0)},o(n){I(t.$$.fragment,n),s=!1},d(n){n&&y(e),R(t)}}}function we(a){let e,t,l,s,n,i,z="A peculiar arrangement of books catches your eye...",h,w,g,D,u,o=a[4]>.5&&a[4]<.8&&ne();return{c(){e=S("div"),t=S("div"),l=S("div"),s=H(),n=S("div"),i=S("span"),i.textContent=z,h=H(),o&&o.c(),this.h()},l(r){e=V(r,"DIV",{class:!0});var d=L(e);t=V(d,"DIV",{class:!0,role:!0,"aria-label":!0,tabindex:!0});var T=L(t);l=V(T,"DIV",{class:!0,style:!0}),L(l).forEach(y),s=C(T),n=V(T,"DIV",{class:!0,style:!0});var A=L(n);i=V(A,"SPAN",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-1bbeums"&&(i.textContent=z),A.forEach(y),h=C(T),o&&o.l(T),T.forEach(y),d.forEach(y),this.h()},h(){b(l,"class","bookshelf-highlight svelte-slpekr"),M(l,"opacity",a[4]>.3?a[4]:0),b(i,"class","hint-text svelte-slpekr"),b(n,"class","bookshelf-hint svelte-slpekr"),M(n,"opacity",a[3]?1:0),M(n,"transform","translateY("+(a[3]?0:10)+"px)"),b(t,"class",w="bookshelf-area "+(a[3]?"hovered":"")+" svelte-slpekr"),b(t,"role","button"),b(t,"aria-label","Interact with the bookshelf"),b(t,"tabindex","0"),b(e,"class","bookshelf-interactive svelte-slpekr")},m(r,d){j(r,e,d),k(e,t),k(t,l),k(t,s),k(t,n),k(n,i),k(t,h),o&&o.m(t,null),D||(u=[W(t,"click",a[10]),W(t,"mouseenter",a[11]),W(t,"mouseleave",a[12]),W(t,"keydown",a[13])],D=!0)},p(r,d){d&16&&M(l,"opacity",r[4]>.3?r[4]:0),d&8&&M(n,"opacity",r[3]?1:0),d&8&&M(n,"transform","translateY("+(r[3]?0:10)+"px)"),r[4]>.5&&r[4]<.8?o?d&16&&p(o,1):(o=ne(),o.c(),p(o,1),o.m(t,null)):o&&(o.d(1),o=null),d&8&&w!==(w="bookshelf-area "+(r[3]?"hovered":"")+" svelte-slpekr")&&b(t,"class",w)},i(r){p(o),r&&(g||J(()=>{g=K(e,X,{duration:500}),g.start()}))},o:ee,d(r){r&&y(e),o&&o.d(),D=!1,ce(u)}}}function ne(a){let e,t="<span>Hold to examine...</span>",l;return{c(){e=S("div"),e.innerHTML=t,this.h()},l(s){e=V(s,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-zyjqha"&&(e.innerHTML=t),this.h()},h(){b(e,"class","mobile-hint svelte-slpekr")},m(s,n){j(s,e,n)},i(s){s&&(l||J(()=>{l=K(e,X,{duration:300}),l.start()}))},o:ee,d(s){s&&y(e)}}}function ie(a){let e,t,l,s;return t=new be({props:{visible:!0}}),{c(){e=S("div"),N(t.$$.fragment),this.h()},l(n){e=V(n,"DIV",{class:!0});var i=L(e);Y(t.$$.fragment,i),i.forEach(y),this.h()},h(){b(e,"class","mt-8")},m(n,i){j(n,e,i),O(t,e,null),s=!0},i(n){s||(p(t.$$.fragment,n),n&&(l||J(()=>{l=K(e,ge,{y:20,duration:800}),l.start()})),s=!0)},o(n){I(t.$$.fragment,n),s=!1},d(n){n&&y(e),R(t)}}}function oe(a){let e,t='<div class="tutorial-content svelte-slpekr"><span>Explore the library by touching different areas...</span></div>',l,s,n;return{c(){e=S("div"),e.innerHTML=t,this.h()},l(i){e=V(i,"DIV",{class:!0,"data-svelte-h":!0}),Z(e)!=="svelte-gegkjq"&&(e.innerHTML=t),this.h()},h(){b(e,"class","mobile-tutorial svelte-slpekr")},m(i,z){j(i,e,z),n=!0},i(i){n||(i&&J(()=>{n&&(s&&s.end(1),l=K(e,X,{duration:800,delay:1500}),l.start())}),n=!0)},o(i){l&&l.invalidate(),i&&(s=pe(e,X,{duration:500})),n=!1},d(i){i&&y(e),i&&s&&s.end()}}}function Ee(a){let e,t,l,s,n,i,z=`<a href="${ye}/" class="text-parchment hover:text-accent transition-colors duration-300 text-lg">‚Üê Return Home</a>`,h,w,g,D,u,o,r,d,T,A,G,B;s=new he({props:{intensity:a[1]?.18:.12,flickerSpeed:.15}}),w=new x({props:{size:"large",position:{x:50,y:20},intensity:a[1]?1.2:1}}),D=new x({props:{size:"medium",position:{x:15,y:40}}}),o=new x({props:{size:"medium",position:{x:85,y:40}}});let v=!a[0]&&te(a),E=a[6]&&le(a),m=a[2]&&se(a),_=a[2]&&!a[0]&&oe();return{c(){e=S("div"),t=S("div"),l=H(),N(s.$$.fragment),n=H(),i=S("div"),i.innerHTML=z,h=H(),N(w.$$.fragment),g=H(),N(D.$$.fragment),u=H(),N(o.$$.fragment),r=H(),d=S("div"),v&&v.c(),T=H(),E&&E.c(),A=H(),m&&m.c(),G=H(),_&&_.c(),this.h()},l(c){e=V(c,"DIV",{class:!0,style:!0});var f=L(e);t=V(f,"DIV",{class:!0}),L(t).forEach(y),l=C(f),Y(s.$$.fragment,f),n=C(f),i=V(f,"DIV",{class:!0,"data-svelte-h":!0}),Z(i)!=="svelte-juls2g"&&(i.innerHTML=z),h=C(f),Y(w.$$.fragment,f),g=C(f),Y(D.$$.fragment,f),u=C(f),Y(o.$$.fragment,f),r=C(f),d=V(f,"DIV",{class:!0});var F=L(d);v&&v.l(F),F.forEach(y),T=C(f),E&&E.l(f),A=C(f),m&&m.l(f),G=C(f),_&&_.l(f),f.forEach(y),this.h()},h(){b(t,"class","absolute inset-0 bg-black/50 z-0"),b(i,"class","absolute bottom-8 left-8 z-50"),b(d,"class","absolute inset-0 z-10"),b(e,"class","library-container min-h-screen overflow-hidden relative svelte-slpekr"),M(e,"background-image","url("+De+")"),M(e,"background-size","cover"),M(e,"background-position","center")},m(c,f){j(c,e,f),k(e,t),k(e,l),O(s,e,null),k(e,n),k(e,i),k(e,h),O(w,e,null),k(e,g),O(D,e,null),k(e,u),O(o,e,null),k(e,r),k(e,d),v&&v.m(d,null),k(e,T),E&&E.m(e,null),k(e,A),m&&m.m(e,null),k(e,G),_&&_.m(e,null),a[14](e),B=!0},p(c,[f]){const F={};f&2&&(F.intensity=c[1]?.18:.12),s.$set(F);const $={};f&2&&($.intensity=c[1]?1.2:1),w.$set($),c[0]?v&&(U(),I(v,1,1,()=>{v=null}),Q()):v?(v.p(c,f),f&1&&p(v,1)):(v=te(c),v.c(),p(v,1),v.m(d,null)),c[6]?E?E.p(c,f):(E=le(c),E.c(),E.m(e,A)):E&&(E.d(1),E=null),c[2]?m?(m.p(c,f),f&4&&p(m,1)):(m=se(c),m.c(),p(m,1),m.m(e,G)):m&&(U(),I(m,1,1,()=>{m=null}),Q()),c[2]&&!c[0]?_?f&5&&p(_,1):(_=oe(),_.c(),p(_,1),_.m(e,null)):_&&(U(),I(_,1,1,()=>{_=null}),Q())},i(c){B||(p(s.$$.fragment,c),p(w.$$.fragment,c),p(D.$$.fragment,c),p(o.$$.fragment,c),p(v),p(m),p(_),B=!0)},o(c){I(s.$$.fragment,c),I(w.$$.fragment,c),I(D.$$.fragment,c),I(o.$$.fragment,c),I(v),I(m),I(_),B=!1},d(c){c&&y(e),R(s),R(w),R(D),R(o),v&&v.d(),E&&E.d(),m&&m.d(),_&&_.d(),a[14](null)}}}const De="https://kxmwcpeuiklblpehddkz.supabase.co/storage/v1/object/public/suspects//library.jpeg";function Ie(a,e,t,l){return Math.sqrt(Math.pow(t-a,2)+Math.pow(l-e,2))}function Me(a,e,t){let l=!1,s=!1,n=!1,i=!1,z=!1,h=0;const w=[{id:1,title:"Mortiferous Mushrooms",color:"#8C0000"},{id:2,title:"Aconitum Anthology",color:"#2A003C"},{id:3,title:"Venomous Flora",color:"#39FF14"},{id:4,title:"Dark Rituals",color:"#0A0004"}],g={x:50,y:40,radius:20};let D=0,u={x:0,y:0},o=!1,r;re(()=>{q.playAmbient("library-ambience",{volume:.3,fade:!0,fadeIn:3e3}),setTimeout(()=>t(2,n=!0),100),d()}),fe(()=>{q.stopAmbient("library-ambience",{fade:!0,fadeOut:2e3})});function d(){r&&(r.addEventListener("touchstart",T),r.addEventListener("touchmove",A),r.addEventListener("touchend",G))}function T($){if(l)return;D=Date.now();const P=$.touches[0];B(P),t(6,o=!0),v()}function A($){if(l)return;const P=$.touches[0];B(P),v()}function G($){if(l)return;const P=Date.now()-D;t(6,o=!1),P>300&&h>.7&&m()}function B($){const P=r.getBoundingClientRect();t(5,u={x:($.clientX-P.left)/P.width*100,y:($.clientY-P.top)/P.height*100})}function v(){const $=Ie(u.x,u.y,g.x,g.y);t(4,h=Math.max(0,1-$/g.radius)),t(3,i=h>.3),h>.7&&navigator.vibrate&&navigator.vibrate(Math.floor(h*30)),h>.5&&!z?(z=!0,q.playEffect("creak",{volume:h*.3})):h<.3&&(z=!1)}async function E(){t(1,s=!0),console.log("Puzzle solved, setting puzzleSolved to:",s),q.playEffect("puzzle-solve",{volume:.5}),ke.update($=>[...$,{id:"book-puzzle",description:"The arrangement reveals a hidden message about poisonous plants...",discovered_at:new Date().toISOString(),image:"/images/clues/poisoned-page.png"}]),q.playEffect("secret-reveal",{volume:.4,fade:!0,fadeIn:1e3})}function m(){l||(t(0,l=!0),q.playEffect("bookshelf-creak",{volume:.4}))}function _(){!l&&!i&&(t(3,i=!0),q.playEffect("creak",{volume:.2}))}const c=()=>t(3,i=!1),f=$=>$.key==="Enter"&&m();function F($){ue[$?"unshift":"push"](()=>{r=$,t(7,r)})}return[l,s,n,i,h,u,o,r,w,E,m,_,c,f,F]}class Ae extends de{constructor(e){super(),me(this,e,Me,Ee,ae,{})}}export{Ae as component,Pe as universal};
